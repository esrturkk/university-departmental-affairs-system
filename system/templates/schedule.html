{% load schedule_extras  %}
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Ders Programı</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f9fff9;
            margin: 30px;
        }

        h1 {
            text-align: center;
            color: #2e7d32;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            table-layout: fixed;
        }

        th, td {
            border: 1px solid #c8e6c9;
            padding: 10px;
            text-align: center;
            vertical-align: middle;
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-width: 180px;
        }

        th {
            background-color: #66bb6a;
            color: white;
        }

        td {
            background-color: #e8f5e9;
            font-size: 14px;
        }

        .gun {
            background-color: #c8e6c9;
            font-weight: bold;
            writing-mode: vertical-rl;
            transform: rotate(180deg);
            font-size: 18px;
        }

        .saat {
            background-color: #f0fdf4;
            font-weight: bold;
            width: 120px;
        }

        .ders {
            font-weight: bold;
        }

        .altbilgi {
            font-size: 12px;
            color: #333;
        }
    </style>
</head>
<body>

<h1>Yazılım Mühendisliği Ders Programı</h1>

{% if error %}
    <p style="color:red; text-align:center;">{{ error }}</p>
{% else %}

<table>
    <thead>
        <tr>
            <th rowspan="2">Gün</th>
            <th rowspan="2">Saat</th>
            <th colspan="4">Sınıflar</th>
        </tr>
        <tr>
            <th>1. Sınıf</th>
            <th>2. Sınıf</th>
            <th>3. Sınıf</th>
            <th>4. Sınıf</th>
        </tr>
    </thead>
    <tbody>
        {% for day, day_label in day_names.items %}
            {% for slot in time_slots %}
                <tr>
                    {% if forloop.first %}
                        <td class="gun" rowspan="{{ time_slots|length }}">{{ day_label }}</td>
                    {% endif %}
                    <td class="saat">{{ slot }}</td>
                    {% for sinif in class_names %}
                        {% with day_data=schedule_table|dict_get:day %}
                            {% with slot_data=day_data|dict_get:slot %}
                                {% with entry=slot_data|dict_get:sinif %}
                                    {% if entry %}
                                        <td>
                                            <div class="ders">Ders: {{ entry.course }}</div>
                                            <div class="altbilgi">Derslik: {{ entry.classroom }}</div>
                                            <div class="altbilgi"><i>Öğr. Görv: {{ entry.instructor }}</i></div>
                                            <div class="altbilgi"><b>{{ entry.sinif }}. Sınıf</b></div>
                                        </td>
                                    {% else %}
                                        <td>-</td>
                                    {% endif %}
                                {% endwith %}
                            {% endwith %}
                        {% endwith %}
                    {% endfor %}
                </tr>
            {% endfor %}
            <tr style="height: 15px;"><td colspan="6" style="background-color: #ffffff;"></td></tr>
        {% endfor %}
    </tbody>
</table>

{% endif %}

</body>
</html>
